'Start':
  type: world
  events:
    on walked over Start:
    - if <flag.p:LabatoryQuest.aslist> 
      contains 'Start'
      queue clear
    - run StartAction
'StartAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'Start' 
      queue clear
    - flag LabatoryQuest:->:Start 
    - playsound location:<player.location> sound:GHAST_SCREAM volume:1 pitch:1
    - narrate "<&7><&l>   OMG WTF WAS THAT    !!!"
    - narrate "<&8>I must find my way out    <&4><&l>NOW!"
    - narrate "FORMAT:Quest Given" "Lab Escape"
    
'RoomExit':
  type: world
  events:
    on walked over RoomExit:
    - ^if <flag.p:LabatoryQuest.aslist> 
      contains 'RoomExit' 
      queue clear
    - run RoomExitAction
'RoomExitAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'RoomExit'
      queue clear
    - flag LabatoryQuest:->:RoomExit
    - narrate "<&7>The Hall is blocked off that way, only one way to go."

'StartHallway1':
  type: world
  events:
    on walked over StartHallway1:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway' 
      queue clear
    - run StartHallwayAction
'StartHallway2':
  type: world
  events:
    on walked over StartHallway2:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway'
      queue clear
    - run StartHallwayAction
'StartHallway3':
  type: world
  events:
    on walked over StartHallway3:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway' 
      queue clear
    - run StartHallwayAction
'StartHallwayAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway'
      queue clear
    - flag LabatoryQuest:->:StartHallway
    - narrate "<&8>Something has gone terribly wrong,"
    - wait 1s
    - narrate "<&7>I am ready to face my <&4><&l>NiGhTmArEs..."
    
'StartHallway4':
  type: world
  events:
    on walked over StartHallway4:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway1' 
      queue clear
    - run StartHallway1Action
'StartHallway5':
  type: world
  events:
    on walked over StartHallway5:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway1'
      queue clear
    - run StartHallway1Action
'StartHallway6':
  type: world
  events:
    on walked over StartHallway6:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway1' 
      queue clear
    - run StartHallway1Action
'StartHallway1Action':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'StartHallway1'
      queue clear
    - flag LabatoryQuest:->:StartHallway1
    - narrate "<&8>What has happened here?"
    - wait 1s
    - narrate "<&7>I need to find a way to the <&4><&l>elevators<&7> and fast!"

'EndHallway1':
  type: world
  events:
    on walked over EndHallway1:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'EndHallway'
      queue clear
    - run EndHallwayAction
'EndHallway2':
  type: world
  events:
    on walked over EndHallway2:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'EndHallway'
      queue clear
    - run EndHallwayAction
'EndHallway3':
  type: world
  events:
    on walked over EndHallway3:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'EndHallway'
      queue clear
    - run EndHallwayAction
'EndHallwayAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'EndHallway'
      queue clear
    - flag LabatoryQuest:->:EndHallway
    - narrate "<&8>This way appears to be <&l>blocked."
    - wait 1s
    - narrate "<&7>I need to find a way around the rubble"
    
'LabCheckpoint1':
  type: world
  events:
    on walked over LCP1:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1'
      queue clear
    - run LabCheckpoint1Action
'LabCheckpoint1Action':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1'
      queue clear
    - flag LabatoryQuest:->:LCP1
    - narrate "<&8>CHECKPOINT 1!"
    - wait 1s
    - narrate "<&7>Something odd about that <&l>painting<&7>, Perhaps I should check it out."
    
'LabCheckpoint1Exit':
  type: world
  events:
    on walked over LCP1Exit:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1Exit'
      queue clear
    - run LabCheckpoint1ExitAction
'LabCheckpoint1ExitAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1Exit'
      queue clear
    - flag LabatoryQuest:->:LCP1Exit
    - cast blindness duration:10 power:1
    - wait 1s
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    - wait 1s
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:3
    - wait 1s
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:2
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    
'LCP1End1':
  type: world
  events:
    on walked over LCP1End:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1End'
      queue clear
    - run LCP1EndAction
'LCP1End2':
  type: world
  events:
    on walked over LCP1End2:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1End'
      queue clear
    - run LCP1EndAction
'LCP1End3':
  type: world
  events:
    on walked over LCP1End3:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1End'
      queue clear
    - run LCP1EndAction
'LCP1EndAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP1End'
      queue clear
    - flag LabatoryQuest:->:LCP1End
    - narrate "<&7>Follow the signs to the exit"
    - wait 1s
    - narrate "<&8>These halls are filled with <&4>zombies<&8>, be careful"

'LCP2':
  type: world
  events:
    on walked over LCP2:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP2'
      queue clear
    - run LCP2Action
'LCP2Action':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP2'
      queue clear
    - flag LabatoryQuest:->:LCP2
    - narrate "<&7><&l>Checkpoint 2!"
    - narrate "<&8>Checkpoint 3 is close by"
    - wait 1s
    - narrate "<&7>I think I can squeese through that <&4>vent!"
    
'Vent1':
  type: world
  events:  
    on walked over Vent1:
    - if <flag.p:cooldown> queue clear
    - run Vent1Action
'Vent1Action':
    type: task
    script:
    - ^if <flag.p:cooldown> queue clear
    - narrate "<&4>You Squeeze through the vent"
    - teleport location:-537,9,348,Interiors
    - flag cooldown duration:10
    
'Vent1Back':
  type: world
  events:  
    on walked over Vent1Back:
    - if <flag.p:cooldown> queue clear
    - run Vent1BackAction
'Vent1BackAction':
    type: task
    script:
    - ^if <flag.p:cooldown> queue clear
    - narrate "<&4>You Squeeze through the vent"
    - teleport location:-542,9,348,Interiors
    - flag cooldown duration:10
    
'LCP3':
  type: world
  events:
    on walked over LCP3:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP3'
      queue clear
    - run LCP3Action
'LCP3Action':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LCP3'
      queue clear
    - flag LabatoryQuest:->:LCP3
    - narrate "<&7><&l>Checkpoint 3!"
    - narrate "<&8>Your way out is near"
    - wait 1s
    - narrate "<&7>I think I can run to the <&4>elevators <&7>from here!"
    
'LabScram1':
  type: world
  events:
    on walked over LABSCREAM1:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LabScream1'
      queue clear
    - run LabScream1Action
'LabScram2':
  type: world
  events:
    on walked over LABSCREAM2:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LabScream1'
      queue clear
    - run LabScream1Action
'LabScram3':
  type: world
  events:
    on walked over LABSCREAM3:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LabScream1'
      queue clear
    - run LabScream1Action
'LabScream1Action':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LabScream1'
      queue clear
    - flag LabatoryQuest:->:LabScream1
    - cast blindness duration:15 power:1
    - wait 1s
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    - wait 1s
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:3
    - wait 1s
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:2
    - playsound location:<player.location> sound:ZOMBIE_WOODBREAK volume:1 pitch:1
    
'LabFinish':
  type: world
  events:
    on walked over LabFinish:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LabFinish'
      queue clear
    - run LabFinishAction
'LabFinishAction':
    type: task
    script:
    - ^if <flag.p:LabatoryQuest.aslist>
      contains 'LabFinish'
      queue clear
    - narrate "<&7><&l>I made it to the Elevators, Let's hope they still work!"
    - flag LabatoryQuest:->:LabFinish
    - ^narrate "FORMAT:Quest Success" "Lab Escape"